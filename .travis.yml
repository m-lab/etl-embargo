# Travis configuration for etl-embargo.

language: go

go:
  - 1.8

before_install:
# Coverage tools
- go get github.com/mattn/goveralls
- go get github.com/wadey/gocovmerge

- echo Branch is ${TRAVIS_BRANCH} and Tag is $TRAVIS_TAG

# Install gcloud, for integration tests.
- $TRAVIS_BUILD_DIR/travis/install_gcloud.sh
- source "${HOME}/google-cloud-sdk/path.bash.inc"

- if [[ -n "$SERVICE_ACCOUNT_mlab_sandbox" ]] ; then
  echo $SERVICE_ACCOUNT_mlab_sandbox | base64 -d > travis-testing.key ;
  gcloud auth activate-service-account --key-file=travis-testing.key ;
  fi

# These directories will be cached on successful "script" builds, and restored,
# if available, to save time on future builds.
cache:
  directories:
    - "$HOME/google-cloud-sdk/"

script:
# TODO: set up test coverage
- go test -v -run Get
- go test -v -run Read
- go test -v -run Should
- go test -v -run Split
- go test -v -run Cal

